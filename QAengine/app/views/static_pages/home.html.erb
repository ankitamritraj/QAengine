<% provide(:title, "QAengine")%>

<% if logged_in? %>
  <div class="row">
    <aside class="col-md-4">
      	<section class="user_info">
        	<%= link_to gravatar_for(current_user, size: 50), current_user %>
			<h1><%= current_user.name %></h1>
			<span>
				<%= link_to "view my profile", current_user %>
			</span>
			<span>
				<%= pluralize(current_user.questions.count, "Question") %>
			</span>
	    </section>
      	<section class="question_form">
        	<%= form_for @question, remote: true do |f| %>
				<div id="field">
				    <%= f.text_area :content, placeholder: "Ask A Question..." %>
			    </div>
			    <%= f.submit "Post", class: "btn btn-primary" %>
			<% end %>
	    </section>
    </aside>
  </div>
    <div class="col-md-8">
      <h3>Question Feed</h3>
      	<% if @feed_items.any? %>
	    	<ol class="microposts">
				<% @feed_items.each do |question| %>
					<li id="question-<%=question.id%>">
						<!-- <b>home mein question id = <%=question.id%></b> -->
						<div id="after-delete-comment-<%=question.id%>">
							<%= link_to gravatar_for(question.user, size: 50), question.user %>
							<span class="user">
								<%= link_to question.user.name, question.user %>
							</span>
							<span class="content">
								<%= question.content %>
							</span>
							<span class="like-question-<%=question.id%>">
									
								<%= link_to like_question_path(question), class: "like", method: :put, remote: true  do%>
									<button type="button" class="btn btn-info" area-label="Left-align">
										<span class = "glyphicon glyphicon-thumbs-up glyphicon-align-center" area-hidden = "true"></span>
										<span class="badge"><%= question.get_upvotes.size%></span>
									</button> 
								<% end %>

								<%= link_to unlike_question_path(question.id), class: "like", method: :put, remote: true do %>
									<button type="button" class="btn btn-info" area-label="Left-align">
										<span class = "glyphicon glyphicon-thumbs-down glyphicon-align-center" area-hidden = "true"></span>
										<span class="badge"><%= question.get_downvotes.size%></span>
									</button> 
								<% end %>
							</span>
							<span class="timestamp">
								Posted <%= time_ago_in_words(question.created_at) %> ago.
							</span>
							<% if current_user == question.user %>
						        <%= link_to "delete", question, method: :delete, data: { confirm: "You sure?", remote: true } %>
	    					<% end %>
	    					<span class="comment-section-<%=question.id%>">
								<% if question.comments.any? %>
									<% question.comments.each do |c| %>
									    <span class="current-comment-id-<%=c.id%>">
											<hr>
											<span>
												<%= link_to c.user.name, c.user%>
											</span>	
											<span>
												<%= c.content %>
											</span>

											<span class="timestamp">
												Posted <%= time_ago_in_words(c.created_at) %> ago.
											</span> 
											<% if current_user == c.user %>
										        <%= link_to "delete", c , method: :delete, data: { confirm: "You sure?" }, remote: true %>
					    					<% end %>
									    </span>
									<% end %>
								<% else %>
									Hello World;
								<% end %>
	    						<%= form_for question.user.comments.build, remote: true do |f| %>
									<div class="field">
									    <%= f.text_area :content, class: "comment-place-holder", placeholder: "Comment here..." %>
									    <%= f.number_field :question_id, :value => question.id %>
								    </div>
								    <%= f.submit "Post", class: "btn btn-primary" %>
								<% end %>
	    					</span>
							<hr>
						</div>
					</li>
				<% end %>
			</ol>
		<% end %>
    </div>
<% else %>
  Sign up Now 
<% end %>
